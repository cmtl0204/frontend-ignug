<div class="p-fluid">
  <form [formGroup]="formUser" (ngSubmit)="onSubmit()">
    <div class="formgrid grid">
      <div class="field xl:col-6 lg:col-6 md:col-12 sm:col-12">
        <label for="identificationType">Tipo de documento:</label>
        <p-dropdown id="identificationType" [options]="identificationTypes" formControlName="identificationType"
                    optionLabel="name" [filter]="true"
                    filterBy="name" [showClear]="true" placeholder="Seleccione">
          <ng-template pTemplate="selectedItem">
            <div class="country-item country-item-value" *ngIf="identificationTypeField.value">
              <div>{{identificationTypeField.value?.name}}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="country-item">
              <div>{{item.name}}</div>
            </div>
          </ng-template>
        </p-dropdown>
        <div
          *ngIf="identificationTypeField.invalid && (identificationTypeField.touched || identificationTypeField.dirty)">
          <small *ngIf="identificationTypeField.errors?.required" id="identification-type-help-1" class="p-error">
            {{messageService.fieldRequired}}
          </small>
        </div>
      </div>
      <div class="field xl:col-6 lg:col-6 md:col-12 sm:col-12">
        <label for="username">Número de documento:</label>
        <input pInputText id="username" formControlName="username">
        <div *ngIf="usernameField.invalid && (usernameField.touched || usernameField.dirty)">
          <small *ngIf="usernameField.errors?.required" id="username-help-1" class="p-error">
            {{messageService.fieldRequired}}
          </small>
        </div>
      </div>
    </div>
    <div class="formgrid grid">
      <div class="field xl:col-6 lg:col-6 md:col-12 sm:col-12">
        <label for="name">Nombres:</label>
        <input pInputText id="name" formControlName="name">
        <div *ngIf="nameField.invalid && (nameField.touched || nameField.dirty)">
          <small *ngIf="nameField.errors?.required" id="name-help-1" class="p-error">
            {{messageService.fieldRequired}}
          </small>
        </div>
      </div>
      <div class="field xl:col-6 lg:col-6 md:col-12 sm:col-12">
        <label for="lastname">Apellidos:</label>
        <input pInputText id="lastname" formControlName="lastname">
        <div *ngIf="lastnameField.invalid && (lastnameField.touched || lastnameField.dirty)">
          <small *ngIf="lastnameField.errors?.required" id="lastname-help-1" class="p-error">
            {{messageService.fieldRequired}}
          </small>
        </div>
      </div>
    </div>

    <div class="field">
      <label for="email">Correo electrónico institucional:</label>
      <input pInputText id="email" formControlName="email">
      <div *ngIf="emailField.invalid && (emailField.touched || emailField.dirty)">
        <small *ngIf="emailField.errors?.required" id="email-help-1" class="p-error">
          {{messageService.fieldRequired}}
        </small>
        <small *ngIf="emailField.errors?.email" id="email-help-2" class="p-error">
          {{messageService.fieldEmail}}
        </small>
      </div>
    </div>

    <div *ngIf="!idField.value">
      <div class="field">
        <p-inputSwitch id="automaticPassword" class="mr-2"
                       (onChange)="generateAutomaticPassword($event)"></p-inputSwitch>
        <label for="automaticPassword"> Generar una contraseña automáticamente</label>
      </div>

      <div *ngIf="!automaticPassword.value" class="field">
        <label for="password">Contraseña:</label>
        <p-password id="password" formControlName="password" promptLabel="Escriba su contraseña" weakLabel="Débil" mediumLabel="Nivel medio"
                    strongLabel="Fuerte" [toggleMask]="true">
        </p-password>
        <div *ngIf="passwordField.invalid && (passwordField.touched || passwordField.dirty)">
          <small *ngIf="passwordField.errors?.required" id="password-help-1" class="p-error">
            {{messageService.fieldRequired}}
          </small>
          <small *ngIf="passwordField.errors?.minlength" id="password-help-2" class="p-error">
            {{messageService.fieldMinLength(passwordField)}}
          </small>
        </div>
      </div>

      <div class="field">
        <p-inputSwitch id="passwordChange" formControlName="passwordChange" class="mr-2"
                       (onChange)="passwordChangeField.setValue($event.checked)"></p-inputSwitch>
        <label for="automaticPassword"> Solicitar un cambio de contraseña la próxima vez que se inicie sesión</label>
      </div>
    </div>

    <div class="field">
      <button pButton pRipple label="Guardar" class="p-button-rounded"
              icon="pi pi-save"></button>
    </div>

    <div class="field" *ngIf="progressBar">
      <p-progressBar mode="indeterminate"></p-progressBar>
    </div>

    <div formArrayName="phones">
      <div *ngFor="let phone of phonesField.controls; let i = index;" [formGroupName]="i">
        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-xl-5 p-lg-5 p-md-5 p-sm-12">
            <p-dropdown [id]="'user'+i" [options]="telephoneOperators" dataKey="id" formControlName="operator" optionLabel="name" [filter]="true" filterBy="name" placeholder="Seleccione...">
              <ng-template pTemplate="selectedItem">
                <div class="country-item country-item-value"
                     *ngIf="phonesField.value[i].socialmedia?.name">
                  <div>
                    {{phonesField.value[i].number?.name}}
                  </div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="country-item">
                  <div>
                    {{item.name}}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="p-field p-xl-5 p-lg-5 p-md-5 p-sm-6">
            <input pInputText [id]="'user'+i" formControlName="user" placeholder="Usuario">
          </div>
<!--          <div class="p-field p-xl-2 p-lg-2 p-md-2 p-sm-12">-->
<!--            <button pButton pRipple type="button" (click)="removeSocialMedia(i)" iconPos="right" icon="pi pi-trash" class="p-button-danger p-button-rounded"></button>-->
<!--          </div>-->
<!--          <div *ngIf="socialMediaField.errors && (socialMediaField.touched || socialMediaField.dirty)">-->
<!--            <small *ngIf="socialMediaField.errors?.required" id="comercialActivities-help-1" class="p-error">-->
<!--              {{messageService.fieldRequired}}-->
<!--            </small>-->
<!--          </div>-->
        </div>
      </div>
    </div>
  </form>
</div>
